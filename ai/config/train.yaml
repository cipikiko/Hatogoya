data:
  hdf5_path: ai/data/plantnet_300K_bytes.h5
  img_size: 800
  num_workers: 0
  cuda_prefetch: true
  prefetch_factor: 2
  use_hdf5: true

train:
  model_name: convnext_tiny.fb_in22k_ft_in1k
  batch_size: 2
  accumulate_steps: 12           # effective batch 24
  grad_checkpoint: true
  lr: 1.6e-4
  weight_decay: 0.05
  epochs: 30
  warmup_epochs: 3
  early_stop_patience: 8
  max_grad_norm: 1.0
  label_smoothing: 0.0
  mixup_alpha: 0.1
  use_weighted_sampler: true

  # NEW (fast validation at high res)
  val_batch_size: 4              # try 3â€“4; increase until it fits
  val_max_batches: 200           # cap per-epoch validation work
